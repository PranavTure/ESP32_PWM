<!DOCTYPE html>
<html>
<head>
  <title>ESP32 LED Brightness</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>

<body style="text-align:center;font-family:Arial;">
  <h1>LED Brightness Control</h1>

  <input type="range" id="slider"
         min="0" max="100" value="0"
         style="width:300px;">

  <p>Brightness: <span id="val">0</span>%</p>

<script>
  const slider = document.getElementById("slider");
  const valTxt = document.getElementById("val");

  const client = mqtt.connect("wss://broker.hivemq.com:8884/mqtt", {
    clientId: "WebClient_" + Math.floor(Math.random() * 10000)
  });

  client.on("connect", () => {
    console.log("Connected");
    client.subscribe("pranav/esp32/led/state");
  });

  // ESP32 feedback
  client.on("message", (topic, message) => {
    const pwm = parseInt(message.toString()); // 0â€“255
    const percent = Math.round((pwm / 255) * 100);

    //slider.value = percent;
    //valTxt.innerText = percent;
  });

  // Slider change
  slider.oninput = () => {
    const percent = slider.value;
    valTxt.innerText = percent;

    const pwm = Math.round((percent / 100) * 255);
    client.publish("pranav/esp32/led/pwm", pwm.toString());
  };
</script>
</body>
</html>



