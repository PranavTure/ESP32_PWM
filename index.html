<!DOCTYPE html>
<html>
<head>
  <title>EPS32 LED BRIGHTNESS CONTROLLER</title>
  <scrip src = "https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>

  <body stype = "text-ligh:senter; font-family:Arial;">
    <h1>LED BRIGTNESS CONTROL</h1>

    <input type = "range" id = "slider" min = "0" max = "100" value = "0" style - width:300px;">

    <p>Brightness: <span id = "val">0</span></p>


    <script>
      const slider = document.getElementById("slider");
      const valTxt = document.getElementById("val");

      const client = mqtt.connect("wss://broker.hivemq.com:8000/mqtt", {
        clientId: "WevClient_" + Math.floor(Math.random() * 10000)
      });

      client.on("connect", () => {
        console.log("Connected");
        client.subscribe("pranav/esp32/led/state");
      });

      // esp32 feedback

      client.on("message", (topic, message) => {
        const pwm = parseInt(message.toString());
        const percent = Math.round((pwm/255) * 100);

        slider.value = percent;
        valTxt.inncerText = percent;
      });

      // slider change

      slider.oninput = () => {
        const percent = slider.value;
        valTxt.innerText = percent;

        const pwm = Math.round((percent/led) * 255);
        client.publish("pranav/esp32/led/pwm", pwm.toString());
      };
    </script>
</html>
